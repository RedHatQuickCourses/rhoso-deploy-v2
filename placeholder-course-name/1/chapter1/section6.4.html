<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Troubleshoot the Data Plane deployment :: Placeholder Course Title</title>
    <link rel="prev" href="section6.3.html">
    <link rel="next" href="section6.5.html">
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://www.redhat.com" target="_blank"><img src="../../../_/img/redhat-logo.png" height="40px" alt="Red Hat"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="../../..">Placeholder Course Title</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://github.com/RedHatQuickCourses/changeme/issues" target="_blank">Report Issues</a>
      </div>
    </div>
  </nav>
</header><div class="body">
<div class="nav-container" data-component="placeholder-course-name" data-version="1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Placeholder Course Title</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Home</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="section1.html">Introduction</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section1.1.html">Traditional TripleO deployment verses deployment with OpenShift cluster.</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section1.2.html">RHOSO installation process overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section1.3.html">RHOSO Installation Process in this Training</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section1.4.html">Network Configuration in this Training</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="section2.1.html">Prerequisites for Installation</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section2.2.html">About the Prerequisite Operators</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section2.3.html">Install NMState Operator</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section2.4.html">Install MetalLB Operator</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section2.5.html">Install Cert-Manager Operator</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="section3.1.html">Preparing RHOCP for RHOSP Network Isolation</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section3.2.html">Setting up Node Network Configuration Policy</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section3.3.html">Configuring Network Attachment Definition</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section3.4.html">Configure MetalLB IP Address Pools</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section3.5.html">Setup MetalLB L2 Advertisement configuration</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="section4.html">Storage FIXME</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section4.1.html">Configuring NFS storage</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section4.2.html">storage</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="section5.html">Install control plane</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section5.1.html">Configure the secrets</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section5.2.html">Install the OpenStack Operator</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section5.3.html">Create the OpenStack Control Plane</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section5.4.html">Troubleshoot the OpenStack Control Plane</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section5.5.html">Verify OpenStack control plane configuration</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="section6.html">Create data plane</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section6.1.html">Create the Data Plane Network configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section6.2.html">Create the Data Plane VM</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section6.3.html">Data Plane Deployment</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="section6.4.html">Troubleshoot the Data Plane deployment</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="section6.5.html">Verify data plane deployment</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="section9.html">Access OpenStack</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="section10.html">Express Install</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendix/appendix.html">Appendix A</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Placeholder Course Title</span>
    <span class="version">1</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">Placeholder Course Title</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Placeholder Course Title</a></li>
    <li><a href="section6.html">Create data plane</a></li>
    <li><a href="section6.4.html">Troubleshoot the Data Plane deployment</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Troubleshoot the Data Plane deployment</h1>
<div class="paragraph">
<p><strong>Troubleshooting data plane deployment:</strong></p>
</div>
<div class="paragraph">
<p>Follow below steps to track the progress with the data plane deployment and troubleshoot it.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Check the status of the deployment, it is in progress.</p>
<div class="listingblock execute">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc get openstackdataplanedeployments.dataplane.openstack.org
oc get openstackdataplanenodesets.dataplane.openstack.org</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Sample output</div>
<div class="content">
<pre>NAME                  NODESETS                  STATUS   MESSAGE
openstack-edpm-ipam   ["openstack-edpm-ipam"]   False    Deployment in progress

 . . .

NAME                  STATUS   MESSAGE
openstack-edpm-ipam   False    Deployment in progress</pre>
</div>
</div>
</li>
<li>
<p>List running jobs</p>
<div class="listingblock execute">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc get jobs</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Sample output</div>
<div class="content">
<pre>NAME                                 COMPLETIONS   DURATION   AGE
bootstrap-openstack-edpm-ipam        1/1           103s       2m27s
cinder-db-purge-28585441             1/1           34s        11h
&gt;&gt; download-cache-openstack-edpm-ipam   0/1           43s        43s &lt;&lt;
glance-purge-cron-28585441           1/1           17s        11h
keystone-cron-28585981               1/1           25s        155m
keystone-cron-28586041               1/1           27s        95m
keystone-cron-28586101               1/1           44s        35m</pre>
</div>
</div>
<div class="paragraph">
<p>Make note of the job in progress (not completed) in the above output.</p>
</div>
</li>
<li>
<p>Check the logs of running job to track it&#8217;s progress and investigate any failure.</p>
<div class="listingblock">
<div class="title">Example:</div>
<div class="content">
<pre>oc logs jobs/download-cache-openstack-edpm-ipam -f</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Troubleshooting networking on compute node:</strong></p>
</div>
<div class="paragraph">
<p>Netwroking setup of the data plane deployment could be error prone while you are tweaking your YAML files.
You may loose the connectivity of the compute node due to any misconfiguration in the files.
You may need to tweak the data plane network configuration files for appropriate networking setup (os-net-config) on the compute node.</p>
</div>
<div class="paragraph">
<p>If you are encountering errors related to any network related job, follow these steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Access the compute node and review <code>/etc/os-net-confg/config.yaml</code>.</p>
</li>
<li>
<p>Make necessary tweaks and run <code>os-net-config</code> command manually.</p>
</li>
<li>
<p>Repeate above step until you get the networking setup as desired.</p>
</li>
<li>
<p>You may loose the network access to the compute node due to application of misconfigured os-net-config settings.</p>
</li>
<li>
<p>You may access the node over the console if it is not reachable on the network.</p>
</li>
<li>
<p>Reset the network settings of the compute node with below steps:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Log in to the compute node as the root user via console.</p>
</li>
<li>
<p>Delete OVS bridges:</p>
<div class="listingblock execute">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">ovs-vsctl del-br br-osp
ovs-vsctl del-br br-ex</code></pre>
</div>
</div>
</li>
<li>
<p>Delete current network configuration files:</p>
<div class="listingblock execute">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">rm -f /etc/sysconfig/network-scripts/ifcfg-*</code></pre>
</div>
</div>
</li>
<li>
<p>Reboot the compute node to restore network connectivity.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Once a working configuration is achieved, update related changes in <code>osp-ng-dataplane-node-set-deploy.yaml</code> and <code>osp-ng-dataplane-netconfig.yaml</code> as per requirement.</p>
</li>
<li>
<p>Apply the settings using <code>oc apply</code> command.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Re-run Data Plane Deployment:</strong></p>
</div>
<div class="paragraph">
<p>During troubleshooting, if needed, delete the existing data plane deployment and re-run it:</p>
</div>
<div class="paragraph">
<p>Deleting the data plane node set and deployment will clean up all the related jobs and associated pods and you may start from scratch.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Delete existing deployment:</p>
<div class="listingblock execute">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc delete -f osp-ng-dataplane-deployment.yaml
oc delete -f osp-ng-dataplane-node-set-deploy.yaml</code></pre>
</div>
</div>
</li>
<li>
<p>Re-run the deployment:</p>
<div class="listingblock execute">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc apply -f osp-ng-dataplane-node-set-deploy.yaml
oc apply -f osp-ng-dataplane-deployment.yaml</code></pre>
</div>
</div>
</li>
</ol>
</div>
<nav class="pagination">
  <span class="prev"><a href="section6.3.html">Data Plane Deployment</a></span>
  <span class="next"><a href="section6.5.html">Verify data plane deployment</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <img src="../../../_/img/rhl-logo-red.png" height="40px" alt="Red Hat"  href="https://redhat.com" >
</footer><script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
